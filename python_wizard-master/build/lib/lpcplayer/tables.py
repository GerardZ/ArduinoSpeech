from typing import NamedTuple


class tms_coeffs(NamedTuple):
    num_k: int
    energy_bits: int
    pitch_bits: int
    kbits: tuple
    energytable: tuple
    pitchtable: tuple
    ktable: tuple
    chirptable: tuple
    interp_coeff: tuple


TI_0280_PATENT_ENERGY = (0, 0, 1, 1, 2, 3, 5, 7, 10, 15, 21, 30, 43, 61, 86, 0)

TI_028X_LATER_ENERGY = (0, 1, 2, 3, 4, 6, 8, 11, 16, 23, 33, 47, 63, 85, 114, 0)

# pitch

TI_0280_2801_PATENT_PITCH = (0, 41, 43, 45, 47, 49, 51, 53,
                             55, 58, 60, 63, 66, 70, 73, 76,
                             79, 83, 87, 90, 94, 99, 103, 107,
                             112, 118, 123, 129, 134, 140, 147, 153)

TI_2802_PITCH = (0, 16, 18, 19, 21, 24, 26, 28,
                 31, 35, 37, 42, 44, 47, 50, 53,
                 56, 59, 63, 67, 71, 75, 79, 84,
                 89, 94, 100, 106, 112, 126, 141, 150)

TI_5110_PITCH = (0,  15,  16,  17,  19,  21,  22,  25,
                26,  29,  32,  36,  40,  42,  46,  50,
                55,  60,  64,  68,  72,  76,  80,  84,
                86,  93, 101, 110, 120, 132, 144, 159)

TI_2501E_PITCH= (0,  14,  15,  16,  17,  18,  19,  20,
                21,  22,  23,  24,  25,  26,  27,  28,
                29,  30,  31,  32,  34,  36,  38,  40,
                41,  43,  45,  48,  49,  51,  54,  55,
                57,  60,  62,  64,  68,  72,  74,  76,
                81,  85,  87,  90,  96,  99, 103, 107,
                112, 117, 122, 127, 133, 139, 145, 151,
                157, 164, 171, 178, 186, 194, 202, 211)

TI_5220_PITCH = (
    # /* P */
    0, 15, 16, 17, 18, 19, 20, 21,
    22, 23, 24, 25, 26, 27, 28, 29,
    30, 31, 32, 33, 34, 35, 36, 37,
    38, 39, 40, 41, 42, 44, 46, 48,
    50, 52, 53, 56, 58, 60, 62, 65,
    68, 70, 72, 76, 78, 80, 84, 86,
    91, 94, 98, 101, 105, 109, 114, 118,
    122, 127, 132, 137, 142, 148, 153, 159)

TI_0280_PATENT_LPC = (
    # /* K1  */
    (-501, -497, -493, -488, -480, -471, -460, -446,
     -427, -405, -378, -344, -305, -259, -206, -148,
     -86, -21, 45, 110, 171, 227, 277, 320,
     357, 388, 413, 434, 451, 464, 474, 498),
    # /* K2  */
    (-349, -328, -305, -280, -252, -223, -192, -158,
     -124, -88, -51, -14, 23, 60, 97, 133,
     167, 199, 230, 259, 286, 310, 333, 354,
     372, 389, 404, 417, 429, 439, 449, 506),
    # /* K3  */
    (-397, -365, -327, -282, -229, -170, -104, -36,
     35, 104, 169, 228, 281, 326, 364, 396),
    # /* K4  */
    (-369, -334, -293, -245, -191, -131, -67, -1,
     64, 128, 188, 243, 291, 332, 367, 397),
    # /* K5  */
    (-319, -286, -250, -211, -168, -122, -74, -25,
     24, 73, 121, 167, 210, 249, 285, 318),
    # /* K6  */
    (-290, -252, -209, -163, -114, -62, -9, 44,
     97, 147, 194, 238, 278, 313, 344, 371),
    # /* K7  */
    (-291, -256, -216, -174, -128, -80, -31, 19,
     69, 117, 163, 206, 246, 283, 316, 345),
    # /* K8  */
    (-218, -133, -38, 59, 152, 235, 305, 361),
    # /* K9  */
    (-226, -157, -82, -3, 76, 151, 220, 280),
    # /* K10 */
    (-179, -122, -61, 1, 62, 123, 179, 231))

TI_2801_2501E_LPC = (
    # /* K1  */
    ( -501, -498, -495, -490, -485, -478, -469, -459,
        -446, -431, -412, -389, -362, -331, -295, -253,
        -207, -156, -102,  -45,   13,   70,  126,  179,
        228,  272,  311,  345,  374,  399,  420,  437 ),
    # /* K2  */
    ( -376, -357, -335, -312, -286, -258, -227, -195,
        -161, -124,  -87,  -49,  -10,   29,   68,  106,
        143,  178,  212,  243,  272,  299,  324,  346,
        366,  384,  400,  414,  427,  438,  448,  506 ),
    # /* K3  */
    ( -407, -381, -349, -311, -268, -218, -162, -102,
        -39,   25,   89,  149,  206,  257,  302,  341 ),
    # /* K4  */
    ( -290, -252, -209, -163, -114,  -62,   -9,   44,
        97,  147,  194,  238,  278,  313,  344,  371 ),
    # /* K5  */
    ( -318, -283, -245, -202, -156, -107,  -56,   -3,
        49,  101,  150,  196,  239,  278,  313,  344 ),
    # /* K6  */
    ( -193, -152, -109,  -65,  -20,   26,   71,  115,
        158,  198,  235,  270,  301,  330,  355,  377 ),
    # /* K7  */
    ( -254, -218, -180, -140,  -97,  -53,   -8,   36,
        81,  124,  165,  204,  240,  274,  304,  332 ),
    # /* K8  */
    ( -205, -112,  -10,   92,  187,  269,  336,  387 ),
    # /* K9  */
    ( -249, -183, -110,  -32,   48,  126,  198,  261 ),
    # /* on patents 4,403,965 and 4,946,391 the 4th entry is 0x3ED (-19) which is a typo of the correct value of 0x3E0 (-32)*/
    # /* K10 */
    ( -190, -133, -73, -10, 53, 115, 173, 227))


TI_5110_5220_LPC = (
    # /* K1  */
    (-501, -498, -497, -495, -493, -491, -488, -482,
     -478, -474, -469, -464, -459, -452, -445, -437,
     -412, -380, -339, -288, -227, -158, -81, -1,
     80, 157, 226, 287, 337, 379, 411, 436),
    # /* K2  */
    (-328, -303, -274, -244, -211, -175, -138, -99,
     -59, -18, 24, 64, 105, 143, 180, 215,
     248, 278, 306, 331, 354, 374, 392, 408,
     422, 435, 445, 455, 463, 470, 476, 506),
    # /* K3  */
    (-441, -387, -333, -279, -225, -171, -117, -63,
     -9, 45, 98, 152, 206, 260, 314, 368),
    # /* K4  */
    (-328, -273, -217, -161, -106, -50, 5, 61,
     116, 172, 228, 283, 339, 394, 450, 506),
    # /* K5  */
    (-328, -282, -235, -189, -142, -96, -50, -3,
     43, 90, 136, 182, 229, 275, 322, 368),
    # /* K6  */
    (-256, -212, -168, -123, -79, -35, 10, 54,
     98, 143, 187, 232, 276, 320, 365, 409),
    # /* K7  */
    (-308, -260, -212, -164, -117, -69, -21, 27,
     75, 122, 170, 218, 266, 314, 361, 409),
    # /* K8  */
    (-256, -161, -66, 29, 124, 219, 314, 409),
    # /* K9  */
    (-256, -176, -96, -15, 65, 146, 226, 307),
    # /* K10 */
    (-205, -132, -59, 14, 87, 160, 234, 307))

# /* chirp */
TI_0280_PATENT_CHIRP = (
    # /* Chirp table */
    0x00, 0x2a, 0xd4, 0x32, 0xb2, 0x12, 0x25, 0x14,
    0x02, 0xe1, 0xc5, 0x02, 0x5f, 0x5a, 0x05, 0x0f,
    0x26, 0xfc, 0xa5, 0xa5, 0xd6, 0xdd, 0xdc, 0xfc,
    0x25, 0x2b, 0x22, 0x21, 0x0f, 0xff, 0xf8, 0xee,
    0xed, 0xef, 0xf7, 0xf6, 0xfa, 0x00, 0x03, 0x02,
    0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00)

TI_LATER_CHIRP = (
    # /* Chirp table */
    0x00, 0x03, 0x0f, 0x28, 0x4c, 0x6c, 0x71, 0x50,
    0x25, 0x26, 0x4c, 0x44, 0x1a, 0x32, 0x3b, 0x13,
    0x37, 0x1a, 0x25, 0x1f, 0x1d, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00)

# /* Interpolation Table */
TI_INTERP = (
    # /* interpolation shift coefficients */
    0, 3, 3, 3, 2, 2, 1, 1)

tms5100 = tms_coeffs(
    10,
    4,
    5,
    (5, 5, 4, 4, 4, 4, 4, 3, 3, 3),
    TI_0280_PATENT_ENERGY,
    TI_0280_2801_PATENT_PITCH,
    TI_0280_PATENT_LPC,
    TI_0280_PATENT_CHIRP,
    TI_INTERP
)

tms5110a = tms_coeffs(
    10,
    4,
    5,
    (5, 5, 4, 4, 4, 4, 4, 3, 3, 3),
    TI_028X_LATER_ENERGY,
    TI_5110_PITCH,
    TI_5110_5220_LPC,
    TI_LATER_CHIRP,
    TI_INTERP
)

tms5200 = tms_coeffs(
    10,
    4,
    6,
    (5, 5, 4, 4, 4, 4, 4, 3, 3, 3),
    TI_028X_LATER_ENERGY,
    TI_2501E_PITCH,
    TI_2801_2501E_LPC,
    TI_LATER_CHIRP,
    TI_INTERP
)

tms5220 = tms_coeffs(
    10,
    4,
    6,
    (5, 5, 4, 4, 4, 4, 4, 3, 3, 3),
    TI_028X_LATER_ENERGY,
    TI_5220_PITCH,
    TI_5110_5220_LPC,
    TI_LATER_CHIRP,
    TI_INTERP
)

tables = {"tms5100": tms5100,
          "tms5110a": tms5110a,
          "tms5200": tms5200,
          "tms5220": tms5220,
         }
